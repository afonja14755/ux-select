var R=Object.defineProperty;var W=(n,c,o)=>c in n?R(n,c,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[c]=o;var m=(n,c,o)=>(W(n,typeof c!="symbol"?c+"":c,o),o),k=(n,c,o)=>{if(!c.has(n))throw TypeError("Cannot "+o)};var s=(n,c,o)=>(k(n,c,"read from private field"),o?o.call(n):c.get(n)),d=(n,c,o)=>{if(c.has(n))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(n):c.set(n,o)},$=(n,c,o,y)=>(k(n,c,"write to private field"),y?y.call(n,o):c.set(n,o),o);var r=(n,c,o)=>(k(n,c,"access private method"),o);var UxSelect=function(){var p,i,_,F,S,z,b,D,L,H,E,B,v,P,w,j,C,I,T,N,q,U,O,V,G,M;"use strict";const n="";function c(A){const e=new Event("change");A.dispatchEvent(e)}function o(A){const e=new Event("input");A.dispatchEvent(e)}class y{constructor(e,t){d(this,_);d(this,S);d(this,b);d(this,L);d(this,E);d(this,v);d(this,w);d(this,C);d(this,T);d(this,q);d(this,O);d(this,G);m(this,"el");d(this,p,void 0);m(this,"config");m(this,"localization");m(this,"state");m(this,"options");m(this,"groups");d(this,i,void 0);this.el=e,$(this,p,t||{isSearchable:!1,isSearchFocus:!1,isGroupOptions:!1,optionStyle:"default",placeholder:"Select an option",searchText:"Search",clearText:"Clear option(s)",selectedText:"Selected:"}),this.config={isSearchable:s(this,p).isSearchable||!1,isSearchFocus:s(this,p).isSearchFocus||!1,isGroupOptions:s(this,p).isGroupOptions||!1,optionStyle:s(this,p).optionStyle||"default"},this.localization={placeholder:s(this,p).placeholder||this.el.dataset.placeholder||"Select an option",searchText:s(this,p).searchText||this.el.dataset.searchText||"Search",clearText:s(this,p).clearText||this.el.dataset.clearText||"Clear option(s)",selectedText:s(this,p).selectedText||this.el.dataset.selectedText||"Selected:"},this.state={multiple:this.el.multiple,disabled:this.el.disabled},this.options=[],this.groups=[],$(this,i,void 0),r(this,_,F).call(this)}disable(){!this.state.disabled&&s(this,i)&&(this.el.disabled=!0,s(this,i).classList.add("-disabled"),this.state.disabled=!0)}enable(){this.state.disabled&&s(this,i)&&(this.el.disabled=!1,s(this,i).classList.remove("-disabled"),this.state.disabled=!1)}update(e=!0){r(this,S,z).call(this),r(this,E,B).call(this),this.el.disabled?this.disable():this.enable(),e&&c(this.el)}clear(){this.options.forEach(e=>{if(e.attributes.selected&&s(this,i)){e.attributes.selected=!1;const t=s(this,i).querySelector(`[data-value="${e.data.value}"]`);t&&t.classList.remove("-selected"),e.element.removeAttribute("selected")}}),r(this,b,D).call(this),c(this.el)}destroy(){s(this,i)&&(s(this,i).remove(),this.el.style.display="")}}return p=new WeakMap,i=new WeakMap,_=new WeakSet,F=function(){r(this,S,z).call(this),r(this,v,P).call(this),r(this,G,M).call(this)},S=new WeakSet,z=function(){const e=this.el.options;if(e.length<=0)throw Error(`Null options at ${this.el}`);this.options=[];for(const t of e){let l;this.config.isGroupOptions?l=t.dataset.uxSelectGroup?t.dataset.uxSelectGroup:"empty":l="empty",this.groups.indexOf(l)===-1&&this.groups.push(l),this.options.push({attributes:{selected:t.getAttribute("selected")!==null,disabled:t.disabled,group:l},data:{text:t.textContent||"",value:t.value},element:t})}},b=new WeakSet,D=function(e=[]){if(s(this,i)){const t=s(this,i).querySelector(".ux-select__title");if(!t)throw Error("selectTitle is null");e.length===1?(t.textContent=e[0],s(this,i).classList.add("-filled")):e.length>0&&this.state.multiple?(t.textContent=`${this.localization.selectedText} ${e.length}`,s(this,i).classList.add("-filled")):(t.textContent=this.localization.placeholder,s(this,i).classList.remove("-filled"))}},L=new WeakSet,H=function(){new Promise(e=>{const t=[];this.options.forEach(l=>{const a=document.createElement("li");if(a.classList.add("ux-select-group__elem"),a.dataset.value=l.data.value,a.textContent=l.data.text,l.attributes.selected&&(a.classList.add("-selected"),t.push(l.data.text!==null?l.data.text:"")),l.attributes.disabled&&a.classList.add("-disabled"),a.addEventListener("click",r(this,q,U).bind(this)),s(this,i)){const h=s(this,i).querySelector(`[data-ux-group="${l.attributes.group}"] .ux-select-group__list`);h&&h.appendChild(a)}}),r(this,b,D).call(this,t),this.config.isGroupOptions?e(!0):e(!1)}).then(e=>{if(e&&s(this,i)){const t=s(this,i).querySelectorAll(".ux-select-group");t.length>0&&t.forEach(l=>{const a=l.querySelector(".ux-select-group__list");if(a){const h=a.querySelectorAll(".ux-select-group__elem"),u=a.querySelectorAll(".ux-select-group__elem.-disabled");h.length===u.length?l.classList.add("-disabled"):l.classList.remove("-disabled")}})}})},E=new WeakSet,B=function(){if(s(this,i)){const e=s(this,i).querySelector(".ux-select__dropdown");if(!e)throw Error("uxSelectList is null");e.innerHTML="",this.groups.forEach(t=>{const l=document.createElement("div");if(l.classList.add("ux-select__group","ux-select-group"),t==="empty"&&l.classList.add("-empty"),l.dataset.uxGroup=t,t!=="empty"){const h=document.createElement("div");h.classList.add("ux-select-group__title"),h.textContent=t,l.appendChild(h)}const a=document.createElement("ul");a.classList.add("ux-select-group__list"),l.appendChild(a),e.appendChild(l)}),r(this,L,H).call(this)}},v=new WeakSet,P=function(){this.el.style.display="none";const e=document.createElement("div");e.classList.add("ux-select__head");const t=document.createElement("div");t.classList.add("ux-select__title"),t.textContent=this.localization.placeholder;const l=document.createElement("button");l.type="button",l.classList.add("ux-select__clear"),l.title=this.localization.clearText,e.append(t,l);const a=document.createElement("div");if(a.classList.add("ux-select__body"),this.config.isSearchable){const x=document.createElement("div");x.classList.add("ux-select__search");const g=document.createElement("input");g.type="search",g.classList.add("ux-select-search__input"),g.placeholder=this.localization.searchText,x.appendChild(g),a.appendChild(x)}const h=document.createElement("div");h.classList.add("ux-select__dropdown"),a.appendChild(h);const u=document.createElement("div"),f=["ux-select",this.el.classList];this.state.multiple&&f.push("-multiple"),this.state.disabled&&f.push("-disabled"),this.config.optionStyle!=="default"&&f.push(`-${this.config.optionStyle}`),u.className=f.join(" "),u.append(e,a),this.el.insertAdjacentElement("afterend",u),this.el.nextElementSibling&&$(this,i,this.el.nextElementSibling),r(this,E,B).call(this)},w=new WeakSet,j=function(e){e.preventDefault();const t=e.target;if(this.state.disabled)return;if(!s(this,i))throw Error("uxEl is null");const l=s(this,i).querySelector(".ux-select__body");if(!l)throw Error("uxSelectBody is null");if(e.target!==s(this,i).querySelector(".ux-select__clear")&&!l.contains(t)){if(s(this,i).classList.contains("-shown"))s(this,i).classList.remove("-shown");else if(s(this,i).classList.add("-shown"),this.config.isSearchable){const a=s(this,i).querySelector(".ux-select-search__input");if(!a)throw Error("Search input is null");a.value="",a.dispatchEvent(new Event("input")),this.config.isSearchFocus&&a.focus()}}},C=new WeakSet,I=function(e){const t=e.target;if(!s(this,i))throw Error("uxEl is null");s(this,i).contains(t)||s(this,i).classList.remove("-shown")},T=new WeakSet,N=function(e){return e.preventDefault(),this.state.disabled?!1:this.clear()},q=new WeakSet,U=function(e){if(e.preventDefault(),e.target!==null){const t=e.target;if(t.classList.contains("-disabled"))return!1;if(this.state.multiple){e.stopPropagation();const l=this.el.querySelector(`[value="${t.dataset.value}"]`);if(!l)throw Error("Option equal this value not found");t.classList.contains("-selected")?l.removeAttribute("selected"):l.setAttribute("selected","")}else if(!t.classList.contains("-selected"))this.el.querySelectorAll("option").forEach(l=>{l.value===t.dataset.value?l.setAttribute("selected",""):l.removeAttribute("selected")});else return!1;return this.update()}},O=new WeakSet,V=function(e){if(e.target!==null&&s(this,i)){const t=e.target,l=t.value.toLowerCase(),a=s(this,i).querySelectorAll(".ux-select-group");if(l==="")s(this,i).querySelectorAll(".ux-select-group__elem").forEach(u=>u.style.display=""),this.config.isGroupOptions&&a.forEach(u=>u.style.display="");else{const h=new RegExp(l);new Promise(u=>{this.options.forEach(f=>{if(!s(this,i))throw Error("uxEl is null");const x=h.test(f.data.text.toLowerCase()),g=s(this,i).querySelector(`[data-value="${f.data.value}"]`);if(!g)throw Error("uxOption is null");g.style.display=x?"":"none"}),this.config.isGroupOptions?u(!0):u(!1)}).then(u=>{u&&a.forEach(f=>{const x=f.querySelector(".ux-select-group__list");f.style.display="",x&&(f.style.display=x.clientHeight!==0?"":"none")})})}o(this.el)}},G=new WeakSet,M=function(){if(s(this,i)){s(this,i).addEventListener("click",r(this,w,j).bind(this));const e=s(this,i).querySelector(".ux-select__clear");if(e&&e.addEventListener("click",r(this,T,N).bind(this)),window.addEventListener("click",r(this,C,I).bind(this)),this.config.isSearchable){const t=s(this,i).querySelector(".ux-select-search__input");t&&t.addEventListener("input",r(this,O,V).bind(this))}}},y}();
