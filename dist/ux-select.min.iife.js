var M=Object.defineProperty;var R=(n,c,r)=>c in n?M(n,c,{enumerable:!0,configurable:!0,writable:!0,value:r}):n[c]=r;var g=(n,c,r)=>(R(n,typeof c!="symbol"?c+"":c,r),r),A=(n,c,r)=>{if(!c.has(n))throw TypeError("Cannot "+r)};var l=(n,c,r)=>(A(n,c,"read from private field"),r?r.call(n):c.get(n)),u=(n,c,r)=>{if(c.has(n))throw TypeError("Cannot add the same private member more than once");c instanceof WeakSet?c.add(n):c.set(n,r)},$=(n,c,r,S)=>(A(n,c,"write to private field"),S?S.call(n,r):c.set(n,r),r);var o=(n,c,r)=>(A(n,c,"access private method"),r);var UxSelect=function(){var s,y,B,m,k,b,z,_,F,E,D,L,H,v,P,w,j,C,I,q,N,T,U,O,V;"use strict";const n="";function c(G){const t=new Event("change");G.dispatchEvent(t)}function r(G){const t=new Event("input");G.dispatchEvent(t)}class S{constructor(t,e){u(this,y);u(this,m);u(this,b);u(this,_);u(this,E);u(this,L);u(this,v);u(this,w);u(this,C);u(this,q);u(this,T);u(this,O);g(this,"el");g(this,"config");g(this,"localization");g(this,"state");g(this,"options");g(this,"groups");u(this,s,void 0);this.el=t,this.config={isSearchable:e.isSearchable||!1,isSearchFocus:e.isSearchFocus||!1,isGroupOptions:e.isGroupOptions||!1,optionStyle:e.optionStyle||"default"},this.localization={placeholder:this.el.dataset.placeholder||e.placeholder||"Select an option",searchText:this.el.dataset.searchText||e.searchText||"Search",clearText:this.el.dataset.clearText||e.clearText||"Clear option(s)",selectedText:this.el.dataset.selectedText||e.selectedText||"Selected:"},this.state={multiple:this.el.multiple,disabled:this.el.disabled},this.options=[],this.groups=[],$(this,s,void 0),o(this,y,B).call(this)}disable(){!this.state.disabled&&l(this,s)&&(this.el.disabled=!0,l(this,s).classList.add("-disabled"),this.state.disabled=!0)}enable(){this.state.disabled&&l(this,s)&&(this.el.disabled=!1,l(this,s).classList.remove("-disabled"),this.state.disabled=!1)}update(t=!0){o(this,m,k).call(this),o(this,E,D).call(this),this.el.disabled?this.disable():this.enable(),t&&c(this.el)}clear(){this.options.forEach(t=>{if(t.attributes.selected&&l(this,s)){t.attributes.selected=!1;const e=l(this,s).querySelector(`[data-value="${t.data.value}"]`);e&&e.classList.remove("-selected"),t.element.removeAttribute("selected")}}),o(this,b,z).call(this),c(this.el)}destroy(){l(this,s)&&(l(this,s).remove(),this.el.style.display="")}}return s=new WeakMap,y=new WeakSet,B=function(){o(this,m,k).call(this),o(this,L,H).call(this),o(this,O,V).call(this)},m=new WeakSet,k=function(){const t=this.el.options;if(t.length<=0)throw Error(`Null options at ${this.el}`);this.options=[];for(const e of t){let i;this.config.isGroupOptions?i=e.dataset.uxSelectGroup?e.dataset.uxSelectGroup:"empty":i="empty",this.groups.indexOf(i)===-1&&this.groups.push(i),this.options.push({attributes:{selected:e.getAttribute("selected")!==null,disabled:e.disabled,group:i},data:{text:e.textContent||"",value:e.value},element:e})}},b=new WeakSet,z=function(t=[]){if(l(this,s)){const e=l(this,s).querySelector(".ux-select__title");if(!e)throw Error("selectTitle is null");t.length===1?(e.textContent=t[0],l(this,s).classList.add("-filled")):t.length>0&&this.state.multiple?(e.textContent=`${this.localization.selectedText} ${t.length}`,l(this,s).classList.add("-filled")):(e.textContent=this.localization.placeholder,l(this,s).classList.remove("-filled"))}},_=new WeakSet,F=function(){new Promise(t=>{const e=[];this.options.forEach(i=>{const a=document.createElement("li");if(a.classList.add("ux-select-group__elem"),a.dataset.value=i.data.value,a.textContent=i.data.text,i.attributes.selected&&(a.classList.add("-selected"),e.push(i.data.text!==null?i.data.text:"")),i.attributes.disabled&&a.classList.add("-disabled"),a.addEventListener("click",o(this,q,N).bind(this)),l(this,s)){const d=l(this,s).querySelector(`[data-ux-group="${i.attributes.group}"] .ux-select-group__list`);d&&d.appendChild(a)}}),o(this,b,z).call(this,e),this.config.isGroupOptions?t(!0):t(!1)}).then(t=>{if(t&&l(this,s)){const e=l(this,s).querySelectorAll(".ux-select-group");e.length>0&&e.forEach(i=>{const a=i.querySelector(".ux-select-group__list");if(a){const d=a.querySelectorAll(".ux-select-group__elem"),h=a.querySelectorAll(".ux-select-group__elem.-disabled");d.length===h.length?i.classList.add("-disabled"):i.classList.remove("-disabled")}})}})},E=new WeakSet,D=function(){if(l(this,s)){const t=l(this,s).querySelector(".ux-select__dropdown");if(!t)throw Error("uxSelectList is null");t.innerHTML="",this.groups.forEach(e=>{const i=document.createElement("div");if(i.classList.add("ux-select__group","ux-select-group"),e==="empty"&&i.classList.add("-empty"),i.dataset.uxGroup=e,e!=="empty"){const d=document.createElement("div");d.classList.add("ux-select-group__title"),d.textContent=e,i.appendChild(d)}const a=document.createElement("ul");a.classList.add("ux-select-group__list"),i.appendChild(a),t.appendChild(i)}),o(this,_,F).call(this)}},L=new WeakSet,H=function(){this.el.style.display="none";const t=document.createElement("div");t.classList.add("ux-select__head");const e=document.createElement("div");e.classList.add("ux-select__title"),e.textContent=this.localization.placeholder;const i=document.createElement("button");i.type="button",i.classList.add("ux-select__clear"),i.title=this.localization.clearText,t.append(e,i);const a=document.createElement("div");if(a.classList.add("ux-select__body"),this.config.isSearchable){const f=document.createElement("div");f.classList.add("ux-select__search");const x=document.createElement("input");x.type="search",x.classList.add("ux-select-search__input"),x.placeholder=this.localization.searchText,f.appendChild(x),a.appendChild(f)}const d=document.createElement("div");d.classList.add("ux-select__dropdown"),a.appendChild(d);const h=document.createElement("div"),p=["ux-select",this.el.classList];this.state.multiple&&p.push("-multiple"),this.state.disabled&&p.push("-disabled"),this.config.optionStyle!=="default"&&p.push(`-${this.config.optionStyle}`),h.className=p.join(" "),h.append(t,a),this.el.insertAdjacentElement("afterend",h),this.el.nextElementSibling&&$(this,s,this.el.nextElementSibling),o(this,E,D).call(this)},v=new WeakSet,P=function(t){t.preventDefault();const e=t.target;if(this.state.disabled)return;if(!l(this,s))throw Error("uxEl is null");const i=l(this,s).querySelector(".ux-select__body");if(!i)throw Error("uxSelectBody is null");if(t.target!==l(this,s).querySelector(".ux-select__clear")&&!i.contains(e)){if(l(this,s).classList.contains("-shown"))l(this,s).classList.remove("-shown");else if(l(this,s).classList.add("-shown"),this.config.isSearchable){const a=l(this,s).querySelector(".ux-select-search__input");if(!a)throw Error("Search input is null");a.value="",a.dispatchEvent(new Event("input")),this.config.isSearchFocus&&a.focus()}}},w=new WeakSet,j=function(t){const e=t.target;if(!l(this,s))throw Error("uxEl is null");l(this,s).contains(e)||l(this,s).classList.remove("-shown")},C=new WeakSet,I=function(t){return t.preventDefault(),this.state.disabled?!1:this.clear()},q=new WeakSet,N=function(t){if(t.preventDefault(),t.target!==null){const e=t.target;if(e.classList.contains("-disabled"))return!1;if(this.state.multiple){t.stopPropagation();const i=this.el.querySelector(`[value="${e.dataset.value}"]`);if(!i)throw Error("Option equal this value not found");e.classList.contains("-selected")?i.removeAttribute("selected"):i.setAttribute("selected","")}else if(!e.classList.contains("-selected"))this.el.querySelectorAll("option").forEach(i=>{i.value===e.dataset.value?i.setAttribute("selected",""):i.removeAttribute("selected")});else return!1;return this.update()}},T=new WeakSet,U=function(t){if(t.target!==null&&l(this,s)){const e=t.target,i=e.value.toLowerCase(),a=l(this,s).querySelectorAll(".ux-select-group");if(i==="")l(this,s).querySelectorAll(".ux-select-group__elem").forEach(h=>h.style.display=""),this.config.isGroupOptions&&a.forEach(h=>h.style.display="");else{const d=new RegExp(i);new Promise(h=>{this.options.forEach(p=>{if(!l(this,s))throw Error("uxEl is null");const f=d.test(p.data.text.toLowerCase()),x=l(this,s).querySelector(`[data-value="${p.data.value}"]`);if(!x)throw Error("uxOption is null");x.style.display=f?"":"none"}),this.config.isGroupOptions?h(!0):h(!1)}).then(h=>{h&&a.forEach(p=>{const f=p.querySelector(".ux-select-group__list");p.style.display="",f&&(p.style.display=f.clientHeight!==0?"":"none")})})}r(this.el)}},O=new WeakSet,V=function(){if(l(this,s)){l(this,s).addEventListener("click",o(this,v,P).bind(this));const t=l(this,s).querySelector(".ux-select__clear");if(t&&t.addEventListener("click",o(this,C,I).bind(this)),window.addEventListener("click",o(this,w,j).bind(this)),this.config.isSearchable){const e=l(this,s).querySelector(".ux-select-search__input");e&&e.addEventListener("input",o(this,T,U).bind(this))}}},S}();
